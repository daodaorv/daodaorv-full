# C端小程序模块

[根目录](../../CLAUDE.md) > [miniprogram](../) > **miniprogram**

## 模块职责

C端小程序是DaoDaoRV01房车租赁平台的用户端应用，基于uni-app框架开发，支持微信小程序、支付宝小程序、抖音小程序和H5网页应用。为用户提供房车租赁、营地预订、特惠活动、社区交流等核心功能。

## 入口和启动

### 应用配置
- **页面配置**: `pages.json`
- **应用入口**: `main.js`
- **全局样式**: `App.vue`

### 启动方式
```bash
# 微信小程序
npm run dev:mp-weixin

# 支付宝小程序
npm run dev:mp-alipay

# 抖音小程序
npm run dev:mp-toutiao

# H5网页应用
npm run dev:h5
```

### 开发工具
- **HBuilderX**: 推荐的uni-app开发IDE
- **微信开发者工具**: 微信小程序调试
- **支付宝小程序开发工具**: 支付宝小程序调试

## 外部接口

### 页面路由结构
基于uni-app的页面路由系统，在pages.json中配置：

#### 主要页面模块
- **首页**: `pages/index/index` - 房车展示、特惠活动、快捷入口
- **社区**: `pages/community/index` - 社区交流、帖子浏览
- **客服**: `pages/service/index` - 在线客服、帮助中心
- **我的**: `pages/mine/index` - 个人中心、订单管理
- **登录**: `pages/login/index` - 用户认证、多平台登录

#### 功能页面
- **房车详情**: `pages/vehicle-detail/index` - 车辆信息、预订功能
- **房车列表**: `pages/vehicle-list/index` - 房车搜索、筛选列表
- **测试页面**: `pages/test-*` - 开发调试页面

### Tab导航配置
底部导航栏配置：
- 首页 (house.png)
- 社区 (community.png)
- 客服 (service.png)
- 我的 (mine.png)

### API集成
基于uni.request的HTTP客户端，与后端API服务进行数据交互：
- 统一的请求封装
- 认证token处理
- 错误处理机制
- 数据缓存策略

## 核心依赖和配置

### 技术栈
- **框架**: uni-app + Vue 3
- **UI组件库**: uView Plus 3.6.4
- **状态管理**: Pinia 3.0.3
- **日期处理**: dayjs 1.11.18
- **构建工具**: uni-app CLI

### 主要依赖
```json
{
  "dayjs": "^1.11.18",
  "pinia": "^3.0.3",
  "uview-plus": "^3.6.4"
}
```

### uView Plus UI组件
完整的UI组件库，包括：
- 基础组件：按钮、输入框、图标等
- 表单组件：表单验证、选择器等
- 数据展示：列表、表格、图表等
- 反馈组件：弹窗、提示、加载等
- 布局组件：网格、布局、导航等

## 页面结构详解

### 1. 首页 (`pages/index/`)
#### 核心组件
- **BannerSwiper**: 轮播图组件
- **NoticeBar**: 公告栏组件
- **ServiceGrid**: 服务网格组件
- **MembershipCard**: 会员卡组件
- **SpecialOffers**: 特惠活动组件
- **BookingModule**: 预订模块组件
- **CommunitySection**: 社区模块组件

#### 功能特性
- 房车推荐展示
- 特惠活动推广
- 营地预订入口
- 社区内容展示
- 会员服务引导

### 2. 社区页面 (`pages/community/`)
#### 功能规划
- 帖子列表浏览
- 话题分类筛选
- 内容搜索功能
- 发布/评论/点赞
- 举报和审核

#### 交互特性
- 下拉刷新
- 上拉加载更多
- 图片预览
- 分享功能

### 3. 客服页面 (`pages/service/`)
#### 服务功能
- 在线客服聊天
- 常见问题解答
- 意见反馈
- 服务评价

#### 实时通信
- WebSocket连接
- 消息推送
- 聊天记录
- 文件上传

### 4. 个人中心 (`pages/mine/`)
#### 用户信息
- 个人资料管理
- 实名认证状态
- 驾驶证认证
- 账户安全设置

#### 业务功能
- 我的订单
- 我的优惠券
- 我的收藏
- 钱包余额
- 积分查询

### 5. 登录页面 (`pages/login/`)
#### 多平台登录
- 手机号登录
- 微信一键登录
- 支付宝登录
- 抖音登录

#### 安全功能
- 短信验证码
- 密码登录
- 用户协议
- 隐私政策

## 状态管理

### Pinia Store结构
#### 用户状态管理
- 用户信息缓存
- 登录状态管理
- 权限信息
- 平台信息

#### 应用状态管理
- 全局配置
- 主题设置
- 缓存数据
- 页面状态

#### 业务状态管理
- 购物车状态
- 订单状态
- 消息通知
- 定位信息

## 跨平台适配

### 平台特性支持
#### 微信小程序
- 微信登录授权
- 微信支付集成
- 微信分享功能
- 微信客服消息

#### 支付宝小程序
- 支付宝登录
- 支付宝支付
- 支付宝分享
- 会员服务集成

#### 抖音小程序
- 抖音登录
- 内容推荐
- 短视频集成
- 社交功能

#### H5网页应用
- 响应式布局
- PWA支持
- 浏览器兼容
- 性能优化

### 条件编译
```javascript
// #ifdef MP-WEIXIN
微信小程序特定代码
// #endif

// #ifdef MP-ALIPAY
支付宝小程序特定代码
// #endif

// #ifdef H5
H5网页应用特定代码
// #endif
```

## 性能优化

### 代码优化
- 组件懒加载
- 图片懒加载
- 数据分页加载
- 缓存策略优化

### 资源优化
- 图片压缩优化
- 静态资源CDN
- 代码分包
- 首屏加载优化

### 体验优化
- 骨架屏加载
- 页面预加载
- 下拉刷新
- 上拉加载更多

## 开发规范

### 代码风格
- Vue 3 Composition API
- TypeScript支持 (可选)
- ESLint代码检查
- Prettier代码格式化

### 组件开发
- 单文件组件 (.vue)
- Props和Emit定义
- 生命周期钩子
- 组件复用原则

### 命名规范
- 页面文件：kebab-case
- 组件名称：PascalCase
- 方法名称：camelCase
- 常量名称：UPPER_SNAKE_CASE

## 测试策略

### 调试工具
- **微信开发者工具**: 微信小程序调试
- **支付宝小程序开发工具**: 支付宝小程序调试
- **Chrome DevTools**: H5应用调试
- **HBuilderX**: 统一开发调试环境

### 测试方案
- 真机测试
- 多平台兼容性测试
- 性能测试
- 用户体验测试

## 安全考虑

### 数据安全
- HTTPS传输加密
- 敏感数据加密存储
- 用户隐私保护
- 安全认证机制

### 代码安全
- XSS防护
- CSRF防护
- 代码混淆
- 第三方库安全检查

## 发布部署

### 构建命令
```bash
# 构建微信小程序
npm run build:mp-weixin

# 构建支付宝小程序
npm run build:mp-alipay

# 构建抖音小程序
npm run build:mp-toutiao

# 构建H5应用
npm run build:h5
```

### 发布流程
1. 代码审查和测试
2. 版本号更新
3. 构建生产包
4. 提交平台审核
5. 发布上线

### 版本管理
- 语义化版本控制
- 更新日志维护
- 向下兼容性考虑
- 灰度发布策略

## 常见问题

### Q: 如何处理多平台适配问题？
A: 使用uni-app的条件编译，针对不同平台编写特定代码，同时做好兼容性测试。

### Q: 如何优化小程序包体积？
A: 使用分包加载、图片压缩、代码优化、按需引入组件等方式。

### Q: 如何实现消息推送功能？
A: 结合平台的消息推送API，如微信模板消息、支付宝消息推送等。

### Q: 如何处理支付功能？
A: 集成各平台的支付SDK，如微信支付、支付宝支付，统一支付接口。

## 相关文件清单

### 配置文件
- `pages.json` - 页面路由配置
- `main.js` - 应用入口文件
- `App.vue` - 应用根组件
- `package.json` - 依赖管理

### 页面文件
- `pages/index/index.vue` - 首页
- `pages/community/index.vue` - 社区页面
- `pages/service/index.vue` - 客服页面
- `pages/mine/index.vue` - 个人中心
- `pages/login/index.vue` - 登录页面

### 功能页面
- `pages/vehicle-detail/index.vue` - 房车详情
- `pages/vehicle-list/index.vue` - 房车列表
- `pages/test-*/index.vue` - 测试页面

### 组件文件
- `pages/index/components/` - 首页组件集合
- `static/` - 静态资源文件

## 开发状态

**当前状态**: 基础框架和页面结构完成，包含主要页面和基础组件
**待开发功能**: 完整的业务逻辑实现、API集成、状态管理
**下一步**: 完善核心业务功能，实现与后端API的完整集成

## 变更日志

**2025-10-30**: 模块文档初始化完成，页面结构和组件分析完毕