# 实施任务清单

## 1. 后端基础 API 实现

### 1.1 数据库集成
- [ ] 1.1.1 安装 TypeORM 相关依赖 (`typeorm`, `mysql2`, `reflect-metadata`)
- [ ] 1.1.2 创建 `src/entities/User.ts` 用户实体
- [ ] 1.1.3 创建 `src/entities/Vehicle.ts` 车辆实体
- [ ] 1.1.4 创建 `src/config/database.ts` 数据库配置
- [ ] 1.1.5 在 `app.ts` 中初始化数据库连接
- [ ] 1.1.6 测试数据库连接

### 1.2 认证功能实现
- [ ] 1.2.1 安装 JWT 相关依赖 (`jsonwebtoken`, `bcryptjs`)
- [ ] 1.2.2 创建 `src/utils/jwt.ts` JWT 工具函数
- [ ] 1.2.3 创建 `src/utils/password.ts` 密码加密工具
- [ ] 1.2.4 创建 `src/middlewares/auth.ts` JWT 认证中间件
- [ ] 1.2.5 创建 `src/services/auth.service.ts` 认证服务
- [ ] 1.2.6 创建 `src/controllers/auth.controller.ts` 认证控制器
- [ ] 1.2.7 添加认证路由到 `src/routes/index.ts`

### 1.3 测试 API 实现
- [ ] 1.3.1 创建 `src/services/test.service.ts` 测试服务
- [ ] 1.3.2 创建 `src/controllers/test.controller.ts` 测试控制器
- [ ] 1.3.3 添加测试路由 (`/api/test/ping`, `/api/test/echo`, `/api/test/vehicles`)
- [ ] 1.3.4 创建测试数据种子文件

### 1.4 中间件完善
- [ ] 1.4.1 完善 CORS 配置 (允许所有开发环境域名)
- [ ] 1.4.2 创建 `src/middlewares/validate.ts` 参数验证中间件
- [ ] 1.4.3 创建 `src/middlewares/response.ts` 响应格式化中间件
- [ ] 1.4.4 更新 `app.ts` 注册所有中间件

### 1.5 后端测试
- [ ] 1.5.1 使用 Postman/curl 测试 `/api/test/ping`
- [ ] 1.5.2 测试用户注册接口 `POST /api/auth/register`
- [ ] 1.5.3 测试用户登录接口 `POST /api/auth/login`
- [ ] 1.5.4 测试获取用户信息接口 `GET /api/auth/profile`
- [ ] 1.5.5 测试车辆列表接口 `GET /api/test/vehicles`

## 2. C 端小程序集成

### 2.1 API 请求封装
- [ ] 2.1.1 创建 `src/utils/request.ts` 统一请求工具
- [ ] 2.1.2 配置 API 基础 URL (开发环境: http://localhost:3000)
- [ ] 2.1.3 实现请求拦截器 (添加 token)
- [ ] 2.1.4 实现响应拦截器 (错误处理、toast 提示)
- [ ] 2.1.5 创建 `src/api/auth.ts` 认证 API 封装
- [ ] 2.1.6 创建 `src/api/test.ts` 测试 API 封装

### 2.2 状态管理
- [ ] 2.2.1 创建 `src/store/modules/user.ts` 用户状态管理
- [ ] 2.2.2 实现登录状态管理
- [ ] 2.2.3 实现 token 持久化 (Storage API)
- [ ] 2.2.4 实现用户信息缓存

### 2.3 测试页面
- [ ] 2.3.1 创建 `src/pages/test/index.vue` 测试页面
- [ ] 2.3.2 创建 `src/pages/test/index.config.ts` 页面配置
- [ ] 2.3.3 添加测试页面到 `app.config.ts`
- [ ] 2.3.4 实现 Ping 测试按钮和结果显示
- [ ] 2.3.5 实现登录测试表单
- [ ] 2.3.6 实现车辆列表获取和展示
- [ ] 2.3.7 添加加载状态和错误提示

### 2.4 小程序配置
- [ ] 2.4.1 在微信开发者工具中配置合法域名 (或开启"不校验合法域名")
- [ ] 2.4.2 配置网络请求超时时间
- [ ] 2.4.3 测试小程序编译和运行

### 2.5 小程序测试
- [ ] 2.5.1 测试 Ping 接口调用
- [ ] 2.5.2 测试用户登录流程
- [ ] 2.5.3 测试车辆列表获取
- [ ] 2.5.4 测试 token 持久化
- [ ] 2.5.5 测试错误处理 (网络错误、401、500)

## 3. PC 管理端集成

### 3.1 API 请求封装
- [ ] 3.1.1 安装 axios (`npm install axios`)
- [ ] 3.1.2 创建 `src/utils/request.ts` Axios 实例配置
- [ ] 3.1.3 实现请求拦截器 (添加 token、loading)
- [ ] 3.1.4 实现响应拦截器 (错误处理、消息提示)
- [ ] 3.1.5 创建 `src/api/auth.ts` 认证 API
- [ ] 3.1.6 创建 `src/api/test.ts` 测试 API

### 3.2 状态管理
- [ ] 3.2.1 创建 `src/store/modules/user.ts` 用户状态
- [ ] 3.2.2 实现登录状态管理
- [ ] 3.2.3 实现 token 持久化 (localStorage)
- [ ] 3.2.4 实现路由守卫 (检查登录状态)

### 3.3 测试页面
- [ ] 3.3.1 创建 `src/views/system/test.vue` 系统测试页面
- [ ] 3.3.2 添加测试页面路由
- [ ] 3.3.3 在侧边栏菜单添加"系统测试"入口
- [ ] 3.3.4 实现 API 连通性测试区域
- [ ] 3.3.5 实现登录测试区域
- [ ] 3.3.6 实现数据列表测试区域
- [ ] 3.3.7 使用 Element Plus 组件美化界面

### 3.4 登录页面完善
- [ ] 3.4.1 完善 `src/views/login/index.vue` 登录逻辑
- [ ] 3.4.2 集成真实的登录 API
- [ ] 3.4.3 实现登录成功后跳转
- [ ] 3.4.4 实现记住密码功能 (可选)

### 3.5 PC 管理端测试
- [ ] 3.5.1 测试登录功能
- [ ] 3.5.2 测试 API 连通性
- [ ] 3.5.3 测试数据获取和展示
- [ ] 3.5.4 测试 token 过期处理
- [ ] 3.5.5 测试路由守卫

## 4. 移动管理端集成

### 4.1 API 请求封装
- [ ] 4.1.1 创建 `src/utils/request.ts` 统一请求工具
- [ ] 4.1.2 配置 API 基础 URL
- [ ] 4.1.3 实现请求/响应拦截器
- [ ] 4.1.4 创建 `src/api/auth.ts` 认证 API
- [ ] 4.1.5 创建 `src/api/test.ts` 测试 API

### 4.2 状态管理
- [ ] 4.2.1 创建 `src/store/modules/user.ts` 用户状态
- [ ] 4.2.2 实现登录状态管理
- [ ] 4.2.3 实现 token 持久化

### 4.3 测试页面
- [ ] 4.3.1 创建 `src/pages/test/index.vue` 测试页面
- [ ] 4.3.2 创建 `src/pages/test/index.config.ts` 页面配置
- [ ] 4.3.3 添加测试页面到 `app.config.ts`
- [ ] 4.3.4 实现 API 测试功能
- [ ] 4.3.5 实现登录测试
- [ ] 4.3.6 实现数据展示

### 4.4 移动管理端测试
- [ ] 4.4.1 测试小程序编译
- [ ] 4.4.2 测试 API 调用
- [ ] 4.4.3 测试登录流程
- [ ] 4.4.4 测试数据获取

## 5. 全端联调测试

### 5.1 环境准备
- [ ] 5.1.1 确保 Docker 容器运行 (MySQL, Redis)
- [ ] 5.1.2 启动后端服务 (`cd backend && npm run dev`)
- [ ] 5.1.3 准备测试账号和数据

### 5.2 连通性测试
- [ ] 5.2.1 C 端小程序调用 `/api/test/ping`
- [ ] 5.2.2 PC 管理端调用 `/api/test/ping`
- [ ] 5.2.3 移动管理端调用 `/api/test/ping`
- [ ] 5.2.4 验证所有端响应正常

### 5.3 认证流程测试
- [ ] 5.3.1 C 端小程序注册和登录
- [ ] 5.3.2 PC 管理端登录
- [ ] 5.3.3 移动管理端登录
- [ ] 5.3.4 验证 token 生成和存储
- [ ] 5.3.5 验证 token 在后续请求中使用

### 5.4 数据交互测试
- [ ] 5.4.1 各端获取车辆列表
- [ ] 5.4.2 验证数据格式一致性
- [ ] 5.4.3 验证数据内容一致性
- [ ] 5.4.4 测试数据刷新

### 5.5 错误处理测试
- [ ] 5.5.1 测试网络错误处理 (关闭后端服务)
- [ ] 5.5.2 测试 401 未授权处理 (删除 token)
- [ ] 5.5.3 测试 500 服务器错误处理
- [ ] 5.5.4 验证错误提示友好性

### 5.6 性能测试
- [ ] 5.6.1 测试 API 响应时间
- [ ] 5.6.2 测试并发请求处理
- [ ] 5.6.3 测试大数据量加载

## 6. 文档编写

### 6.1 测试文档
- [ ] 6.1.1 创建 `docs/全端联调测试报告.md`
- [ ] 6.1.2 记录测试环境配置
- [ ] 6.1.3 记录测试用例和结果
- [ ] 6.1.4 记录发现的问题和解决方案
- [ ] 6.1.5 记录性能测试数据

### 6.2 API 文档
- [ ] 6.2.1 创建 `docs/API文档.md`
- [ ] 6.2.2 记录所有 API 接口
- [ ] 6.2.3 记录请求参数和响应格式
- [ ] 6.2.4 记录错误码说明

### 6.3 开发指南
- [ ] 6.3.1 更新 `README.md` 添加联调测试说明
- [ ] 6.3.2 编写前端 API 调用示例
- [ ] 6.3.3 编写常见问题解答

## 7. 代码优化

### 7.1 代码审查
- [ ] 7.1.1 审查后端代码质量
- [ ] 7.1.2 审查前端代码质量
- [ ] 7.1.3 运行 ESLint 检查
- [ ] 7.1.4 修复所有 lint 错误和警告

### 7.2 代码重构
- [ ] 7.2.1 提取公共代码
- [ ] 7.2.2 优化错误处理逻辑
- [ ] 7.2.3 优化请求拦截器
- [ ] 7.2.4 添加代码注释

### 7.3 单元测试 (可选)
- [ ] 7.3.1 为后端 API 编写单元测试
- [ ] 7.3.2 为前端工具函数编写单元测试
- [ ] 7.3.3 运行测试并确保通过

## 8. 部署准备

### 8.1 环境变量配置
- [ ] 8.1.1 创建生产环境配置文件
- [ ] 8.1.2 配置生产环境 API URL
- [ ] 8.1.3 配置生产环境数据库连接

### 8.2 构建测试
- [ ] 8.2.1 测试后端生产构建 (`npm run build`)
- [ ] 8.2.2 测试 PC 管理端生产构建
- [ ] 8.2.3 测试小程序生产构建

## 总结

**总任务数**: 约 120 个任务
**预计完成时间**: 2.5 天
**优先级**: 高 (阻塞后续业务功能开发)

