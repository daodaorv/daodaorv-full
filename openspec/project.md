# Project Context

## Development Mode

**AI 驱动开发模式**:

- ✅ 本项目由 AI 独立完成所有开发工作
- ✅ 产品负责人不具备技术开发能力
- ✅ 所有技术决策、代码实现、测试验证均由 AI 自主完成
- ✅ 如需人工验证，AI 必须提供详细的步骤说明（包括命令、预期结果）
- ✅ 团队协作任务视为 AI 内部工作流程，无需等待人工确认

**OpenSpec 规范要求**:

- ✅ 所有新功能开发**必须**遵循 OpenSpec 工作流程（详见 `openspec/AGENTS.md`）
- ✅ 所有代码变更**必须**先创建变更提案
- ❌ **禁止**绕过 OpenSpec 流程直接修改代码

**项目特定开发流程**:

本项目必须严格遵循以下 8 步循环开发流程（详细说明见下方"Complete Development Workflow"章节）：

1. **步骤 1**: 确认当前开发进度和任务（读取 `docs/开发进度管理.md`）
2. **步骤 2**: 收集完整的开发需求（查阅详细设计文档、数据字典、技术规范）
3. **步骤 3**: 创建 OpenSpec 变更提案（遵循 `openspec/AGENTS.md` 中的标准流程）
4. **步骤 4**: 特殊处理 - C 端小程序页面原型（如适用，需等待用户确认）
5. **步骤 5**: 实现开发任务（按 `tasks.md` 顺序实现，编写测试）
6. **步骤 6**: 完整测试开发结果（100% 测试通过率）
7. **步骤 7**: 归档 OpenSpec 变更（遵循 `openspec/AGENTS.md` 中的归档流程）
8. **步骤 8**: 进入下一循环（更新进度，返回步骤 1）

**关键约束**:

- ❌ **禁止**跳过任何步骤
- ❌ **禁止**在测试未通过时归档变更
- ❌ **禁止**在 C 端页面原型未确认时继续开发
- ✅ **必须**按照 P0 → P1 → P2 的优先级顺序开发
- ✅ **必须**确保依赖的模块已完成后再开发当前模块

## Complete Development Workflow

### 步骤 1：确认当前开发进度和任务

**执行内容**：

1. 读取 `docs/开发进度管理.md`
2. 确认当前应该开发的功能模块
3. 检查优先级（P0 → P1 → P2）
4. 检查依赖关系（确保依赖模块已完成）

**检查点**：

- [ ] 已读取开发进度管理文档
- [ ] 已确认当前任务的优先级
- [ ] 已确认依赖模块已完成

### 步骤 2：收集完整的开发需求

**执行内容**：

1. 查阅相关的详细设计文档：
   - C 端小程序：`docs/小程序端功能详细设计-优化版.md`
   - B 端 PC 管理：`docs/管理端功能详细设计-优化版.md`
   - B 端移动管理：`docs/移动管理端功能详细设计-优化版.md`
2. 查阅 `docs/数据字典.md` 了解数据模型
3. 查阅 `docs/技术规范手册.md` 了解技术约束
4. 如涉及 C 端小程序，查阅 `docs/小程序设计指南.md` 了解设计规范
5. 使用 `codebase-retrieval` 查找相关代码

**检查点**：

- [ ] 已阅读相关功能详细设计文档
- [ ] 已了解数据模型和字段规范
- [ ] 已了解技术栈和开发约束
- [ ] 如涉及 C 端小程序，已阅读小程序设计指南
- [ ] 已查找相关代码实现

### 步骤 3：创建 OpenSpec 变更提案

#### 3.1 判断是否需要创建提案

**需要创建提案**：

- ✅ 新功能开发
- ✅ 破坏性变更（API、数据库 schema）
- ✅ 架构变更
- ✅ 性能优化（改变行为）
- ✅ 安全模式更新

**无需创建提案**：

- ❌ Bug 修复（恢复预期行为）
- ❌ 拼写错误、格式调整、注释
- ❌ 依赖更新（非破坏性）
- ❌ 配置变更
- ❌ 现有行为的测试

#### 3.2 创建提案流程（如需要）

**3.2.1 查阅现有上下文**：

```bash
openspec list                  # 查看活跃的变更
openspec list --specs          # 查看现有规范
```

**3.2.2 选择唯一的 change-id**：

- 使用 kebab-case
- 动词引导：`add-`、`update-`、`remove-`、`refactor-`
- 示例：`add-login-page`、`update-user-auth`

**3.2.3 手动创建目录结构**：

```bash
# 创建变更目录
mkdir -p openspec/changes/<change-id>/specs/<capability>
```

**3.2.4 手动创建文件**：

① **proposal.md**（必需）：

```markdown
## Why

[1-2 句话说明问题/机会]

## What Changes

- [变更列表]
- [用 **BREAKING** 标记破坏性变更]

## Impact

- Affected specs: [列出受影响的能力]
- Affected code: [关键文件/系统]
```

② **tasks.md**（必需）：

```markdown
## 1. Implementation

- [ ] 1.1 创建数据库 schema
- [ ] 1.2 实现 API 端点
- [ ] 1.3 添加前端组件
- [ ] 1.4 编写测试
```

③ **design.md**（可选，仅在以下情况创建）：

- 跨服务/模块变更或新架构模式
- 新外部依赖或重大数据模型变更
- 安全、性能或迁移复杂性
- 技术决策需要在编码前明确

④ **specs/\<capability\>/spec.md**（必需）：

```markdown
## ADDED Requirements

### Requirement: 新功能

系统应当提供...

#### Scenario: 成功案例

- **WHEN** 用户执行操作
- **THEN** 预期结果

## MODIFIED Requirements

### Requirement: 现有功能

[完整的修改后需求]

#### Scenario: 修改后的场景

- **WHEN** ...
- **THEN** ...
```

**⚠️ 关键格式要求**：

- ✅ 场景必须使用 `#### Scenario:` 格式（4 个 #）
- ❌ 不要使用 `- **Scenario:**` 或 `**Scenario**:` 或 `### Scenario:`
- ✅ 每个需求至少包含一个场景
- ✅ 使用 SHALL/MUST 表示规范性需求

**3.2.5 验证提案**：

```bash
openspec validate <change-id> --strict
```

**3.2.6 修复验证错误并等待批准**：

- 检查场景格式是否正确
- 确保每个需求至少有一个场景
- 确保增量操作标题正确
- 等待用户批准提案

**检查点**：

- [ ] 已创建 `openspec/changes/<change-id>/` 目录
- [ ] 已创建 `proposal.md`
- [ ] 已创建 `tasks.md`
- [ ] 已创建 `specs/<capability>/spec.md`
- [ ] 已运行 `openspec validate <change-id> --strict` 并通过
- [ ] 已等待用户批准提案

### 步骤 4：特殊处理 - C 端小程序页面原型（如适用）

**判断是否需要创建原型**：

- ✅ 如果当前开发的是 C 端小程序页面（`miniprogram/pages/` 下的页面）
- ✅ 需要先创建 HTML 原型并等待用户确认
- ❌ 如果是后端 API、B 端管理页面、组件等，跳过此步骤

#### 核心规范: C 端小程序页面原型设计规范

在创建任何 C 端小程序页面原型之前,必须先读取并遵循以下设计规范:

##### 角色设定

你是一位资深前端开发工程师

##### 设计风格

- 现代优雅的极简主义美学与功能的完美平衡
- 清新柔和的渐变配色与品牌色系浑然一体
- 恰到好处的留白设计
- 轻盈通透的沉浸式体验
- 信息层级通过微妙的阴影过渡与模块化卡片布局清晰呈现
- 用户视线能自然聚焦核心功能
- 精心打磨的圆角
- 细腻的微交互
- 舒适的视觉比例

##### 技术规格

1. 参考 `docs/小程序设计指南.md` 中的所有规范(配色、字体、间距、圆角、阴影)
2. 不要显示状态栏以及时间、信号等系统信息
3. 不要显示非移动端元素,如滚动条

##### 执行流程

1. 先完整阅读 `docs/小程序设计指南.md`
2. 提取配色方案、字体规范、间距规范、圆角规范、阴影规范
3. 应用极简主义美学和留白设计
4. 使用模块化卡片布局和微妙阴影
5. 添加细腻的微交互效果
6. 移除状态栏和非移动端元素
7. 创建 HTML 原型文件
8. 向用户汇报并等待确认

#### 4.1 创建 HTML 原型

在 `miniprogram/pages-prototype/index.html` 中添加新页面原型：

1. 在导航菜单中添加新链接
2. 在主内容区域添加新的 `<section id="page-name">`
3. 使用真实的 UI 组件样式（模拟 uView Plus）
4. 实现完整的交互逻辑（JavaScript）
5. 所有页面按功能模块平铺展示

#### 4.2 等待用户确认

- 🛑 **停止开发**，等待用户在浏览器中确认原型
- 📢 **向用户汇报**：原型已创建，请在浏览器中打开 `miniprogram/pages-prototype/index.html` 查看
- ⏳ **等待反馈**：用户确认后才能继续

#### 4.3 移植到正式页面

**移植原则**：

- ✅ **直接复制** HTML 结构、样式、交互逻辑
- ✅ **仅修正** uni-app 特定语法差异
- ❌ **禁止重新解读**需求并重写代码
- ❌ **禁止改变**已确认的设计和交互

**语法修正示例**：

```html
<!-- HTML 原型 -->
<div class="container">
  <img src="logo.png" />
  <span>文本</span>
</div>

<!-- uni-app 正式页面 -->
<view class="container">
  <image src="logo.png" />
  <text>文本</text>
</view>
```

#### 4.4 保留原型

- ✅ **不删除**原型代码
- ✅ 保留在 `index.html` 中作为原型仓库
- ✅ 方便后期微调和参考

**检查点**：

- [ ] 已在 `index.html` 中添加原型
- [ ] 已向用户汇报并等待确认
- [ ] 用户确认后才开始移植
- [ ] 移植时仅修正语法，不改变设计
- [ ] 原型代码已保留在 `index.html` 中

### 步骤 5：实现开发任务

#### 5.1 按 tasks.md 顺序实现

- 严格按照 `tasks.md` 中的顺序逐项实现
- 每完成一项，在对话中汇报进度
- 不要跳过任何任务

#### 5.2 遵循技术规范

**根据文件路径判断技术栈**：

| 文件路径        | 技术栈       | 框架        | UI 组件库        |
| --------------- | ------------ | ----------- | ---------------- |
| `miniprogram/`  | C 端小程序   | uni-app 3.x | uView Plus 3.x   |
| `admin-web/`    | B 端 PC 管理 | Vue 3.3+    | Element Plus 2.x |
| `mobile-admin/` | B 端移动管理 | uni-app 3.x | uView Plus 3.x   |
| `backend/`      | 后端 API     | Koa 2.x     | -                |

**uni-app 开发约束**（`miniprogram/` 和 `mobile-admin/`）：

- ❌ **禁止**使用标准 HTML 标签（`<div>`, `<span>`, `<img>`）
- ✅ **必须**使用 uni-app 内置组件（`<view>`, `<text>`, `<image>`）
- ❌ **禁止**使用 Taro API（`Taro.xxx`）
- ✅ **必须**使用 uni-app API（`uni.xxx`）
- ✅ **必须**使用 uView Plus 组件（`<u-button>`, `<u-input>` 等）

**Vue 3 PC 开发约束**（`admin-web/`）：

- ✅ 使用标准 HTML 标签（`<div>`, `<span>`, `<img>`）
- ✅ 使用 Element Plus 组件（`<el-button>`, `<el-input>` 等）
- ✅ 使用 Vue 3 Composition API

#### 5.3 同步编写测试

- 开发新功能时，必须同步编写测试
- 测试框架：Jest + Supertest
- 测试类型：
  - 单元测试（Service 层、工具函数）
  - 集成测试（API 端点、数据库操作）
  - E2E 测试（关键业务流程）

#### 5.4 使用 codebase-retrieval 确认细节

**在调用任何类、方法、属性前，必须先查询确认**：

示例：如果要调用 UserService.login() 方法
→ 先使用 codebase-retrieval 查询："UserService 类的 login 方法签名和参数"
→ 确认方法存在、参数类型、返回值后再使用

**查询内容**：

- 类的完整签名
- 方法的参数和返回值
- 属性的类型
- 依赖的导入路径

**检查点**：

- [ ] 已按 `tasks.md` 顺序实现所有任务
- [ ] 已遵循正确的技术栈规范
- [ ] 已同步编写测试
- [ ] 已使用 `codebase-retrieval` 确认所有使用的类/方法/属性

### 步骤 6：完整测试开发结果

#### 6.1 运行所有测试

```bash
# 后端测试
cd backend
npm test

# 前端测试（如有）
cd admin-web
npm test
```

#### 6.2 测试要求

- ✅ **100% 测试通过率**（强制要求）
- ✅ 所有新功能都有对应测试
- ✅ 所有修改的功能都更新了测试
- ✅ 测试覆盖率符合项目要求

#### 6.3 错误处理原则

**最多尝试修复 3 次**：

- 第 1 次失败：分析错误，尝试修复
- 第 2 次失败：深入分析，尝试不同方案
- 第 3 次失败：**立即停止**，向用户报告

**第 3 次失败后的处理流程**：

1. **立即停止**继续尝试修复
2. **完整记录错误**：
   - 错误的完整堆栈信息
   - 已尝试的 3 种修复方案及结果
   - 错误发生的上下文环境
3. **全面分析错误原因**：
   - 根本原因分析（不是表面现象）
   - 可能的影响范围
   - 相关的代码或配置问题
4. **提出解决方案**：
   - 提供 2-3 个可行的解决方案
   - 说明每个方案的优缺点、风险和工作量
   - 推荐最佳方案并说明理由
5. **等待用户选择**：由用户判断并选择解决方案

**禁止行为**：

- ❌ 不允许绕开错误继续开发
- ❌ 不允许隐藏或忽略错误
- ❌ 不允许使用临时性的 workaround 而不解决根本问题

**检查点**：

- [ ] 所有测试已运行
- [ ] 测试通过率 100%
- [ ] 如有错误，已按错误处理原则处理
- [ ] 没有绕开或隐藏的错误

### 步骤 7：归档 OpenSpec 变更

#### 7.1 确认所有任务完成

- 检查 `tasks.md` 中的所有任务是否都已完成
- 确认所有测试通过
- 确认代码已提交

#### 7.2 更新 tasks.md

将所有任务标记为完成：

```markdown
## 1. Implementation

- [x] 1.1 创建数据库 schema
- [x] 1.2 实现 API 端点
- [x] 1.3 添加前端组件
- [x] 1.4 编写测试
```

#### 7.3 运行归档命令

**标准归档**（更新 specs）：

```bash
openspec archive <change-id> --yes
```

**仅工具变更**（不更新 specs）：

```bash
openspec archive <change-id> --skip-specs --yes
```

#### 7.4 验证归档结果

```bash
openspec validate --strict
```

#### 7.5 检查归档位置

- 变更已移动到 `openspec/changes/archive/YYYY-MM-DD-<change-id>/`
- 如果有规范变更，`openspec/specs/` 已更新

**检查点**：

- [ ] 所有任务已完成并标记为 `[x]`
- [ ] 已运行 `openspec archive <change-id> --yes`
- [ ] 已运行 `openspec validate --strict` 并通过
- [ ] 变更已移动到 archive 目录
- [ ] specs 已更新（如适用）

### 步骤 8：更新开发进度并进入下一循环

#### 8.1 更新开发进度管理文档

- 在 `docs/开发进度管理.md` 中标记当前任务为"已完成"
- 更新完成时间
- 添加相关说明

#### 8.2 向用户汇报

- 汇报已完成的功能
- 说明测试结果
- 说明归档情况
- 询问是否继续下一个任务

#### 8.3 返回步骤 1

- 重新读取开发进度管理文档
- 确认下一个任务
- 开始新的循环

**检查点**：

- [ ] 已更新开发进度管理文档
- [ ] 已向用户汇报完成情况
- [ ] 已准备好进入下一循环

## Purpose

DaoDaoRV01 是一个专注于房车租赁服务的综合性平台,为用户提供房车预订、营地预订、定制旅游、社区互动等一站式房车旅行服务。

**核心业务价值**:

- 为 C 端用户提供便捷的房车租赁和旅行服务
- 为 B 端运营团队提供完整的管理和配置能力
- 通过众筹模式让用户共享房车租赁收益
- 构建完整的房车旅行生态圈

**业务目标**:

- 短期(3-6 个月): 用户注册量 10,000 人,月活 3,000 人,订单 500 单/月
- 中期(6-12 个月): 拓展 20 个服务城市,平台房车 500 辆,复购率 30%
- 长期(1-3 年): 成为国内领先的房车租赁平台,实现盈亏平衡

## Tech Stack

### 后端服务

- 运行时: Node.js 18.x LTS
- 框架: Koa 2.x
- 开发语言: TypeScript 5.x
- ORM: TypeORM 0.3.x
- 数据库: MySQL 8.0
- 缓存: Redis 7.x
- 实时通信: Socket.io 4.x
- 任务队列: Bull (基于 Redis)
- 文件存储: 阿里云 OSS
- 支付: 微信支付 SDK + 支付宝 SDK
- 日志: Winston
- 测试: Jest, Supertest, ts-jest
- 进程管理: PM2

### C 端用户应用 (小程序端)

- 框架: uni-app 3.x
- 开发语言: Vue 3.x (Composition API)
- UI 组件库: uView Plus 3.x
- 状态管理: Pinia 2.x
- HTTP 请求: uni.request 封装
- 支持平台: 微信小程序、支付宝小程序、抖音小程序、H5 网页版

### B 端 PC 管理系统

- 框架: Vue 3.3+
- 构建工具: Vite 4.x
- UI 组件库: Element Plus 2.x
- 状态管理: Pinia
- 路由: Vue Router 4.x
- HTTP 请求: Axios
- 图表: ECharts 5.x
- 富文本: Quill / TinyMCE

### B 端移动管理工具

- 框架: uni-app 3.x
- 开发语言: Vue 3.x (Composition API)
- UI 组件库: uView Plus 3.x + 自定义组件
- 状态管理: Pinia 2.x
- 目标平台: 微信小程序、H5 网页版、支付宝小程序

### 部署环境

- 操作系统: CentOS 7.x / Ubuntu 20.04 LTS
- 面板: 宝塔 Linux 面板 7.x
- Web 服务器: Nginx 1.22+
- 容器: Docker (MySQL, Redis)

**详细技术规范**: 见 `docs/技术规范手册.md` (2268 行)

- uni-app 多端编译约束和平台 API 差异对照表
- 路由跳转、网络请求、本地存储、支付功能、文件上传等多端适配方案
- 性能优化、安全规范、测试规范

## Project Conventions

### Code Style

**代码格式化**:

- 使用 ESLint + Prettier 进行代码格式化
- TypeScript 严格模式开启
- 所有代码必须通过 ESLint 检查才能提交

**命名约定**:

- 组件: PascalCase (例如: UserProfile, VehicleCard)
- 函数: camelCase (例如: getUserData, calculatePrice)
- 常量: UPPER_SNAKE_CASE (例如: API_BASE_URL, MAX_RENTAL_DAYS)
- 文件: kebab-case (例如: user-profile.vue, vehicle-list.ts)
- 类名: PascalCase (例如: UserService, OrderController)
- 接口名: PascalCase,以 I 开头 (例如: IUser, IVehicle)
- 类型名: PascalCase (例如: UserType, OrderStatus)

**代码标识符语言规范**:

- ✅ 所有代码标识符(变量名、函数名、类名、接口名、类型名)使用英文命名
- ✅ 代码注释使用中文编写,提高团队可读性
- ✅ 文档和对外沟通使用中文
- ✅ 内部逻辑推理可使用英文思考

**代码质量要求**:

- 优先使用本地功能,避免不必要的网络请求
- 追求最佳用户体验和响应速度
- 合理利用本地资源,提升性能效率
- 函数单一职责,保持简洁
- 避免过度设计,默认实现<100 行代码

### Architecture Patterns

**整体架构**:

- 前后端分离架构
- RESTful API 设计规范
- 微服务化思想(按业务模块拆分)
- 统一后端 API 层服务所有前端

**前端架构**:

- 组件化开发,组件可复用
- 状态管理使用 Pinia
- 路由懒加载,按需加载
- API 统一封装,集中管理

**后端架构**:

- MVC 分层架构 (Controller -> Service -> Model)
- 中间件模式 (认证、权限、日志、错误处理)
- 依赖注入,降低耦合
- 统一响应格式

**数据库设计**:

- 规范化设计,避免数据冗余
- 合理使用索引,优化查询性能
- 敏感数据加密存储
- 定期备份,异地存储

**详细数据字典**: 见 `docs/数据字典.md` (665 行)

- 核心数据模型定义 (User, Vehicle, Order, CrowdfundingProject 等)
- 枚举值定义 (UserStatus, VehicleStatus, OrderStatus 等)
- 数据关系图和字段规范

### Testing Strategy

**测试要求**:

- 测试框架: Jest + Supertest
- 覆盖率要求: **每个 API 模块必须达到 100% 测试通过率**
- 测试范围: Service 层、Controller 层、工具函数、关键组件
- 测试环境: Docker MySQL (端口 3307) + Redis (端口 6379)

**测试原则**:

- ✅ 开发新功能时**必须**同步编写测试
- ✅ 修复 Bug 时**必须**补充测试用例
- ✅ 重构代码前**必须**确保测试通过
- ✅ 所有 API 接口**必须**有完整的测试覆盖 (成功场景 + 失败场景)

**测试类型**:

- 单元测试: Service 层业务逻辑、工具函数
- 集成测试: API 接口、数据库操作、第三方服务集成
- E2E 测试: 关键业务流程端到端测试

### Git Workflow

**分支策略**:

- `main`: 生产环境分支,受保护
- `develop`: 开发主分支
- `feature/*`: 功能开发分支
- `bugfix/*`: Bug 修复分支
- `hotfix/*`: 紧急修复分支

**提交规范** (Conventional Commits):

- `feat`: 新功能
- `fix`: Bug 修复
- `docs`: 文档更新
- `style`: 代码格式调整
- `refactor`: 代码重构
- `test`: 测试相关
- `chore`: 构建/工具链相关

**PR 流程**:

- 所有代码必须通过 PR 合并
- PR 必须经过代码审查
- PR 必须通过 CI 检查
- PR 标题遵循提交规范

## Domain Context

**业务领域知识**:

- 房车租赁业务: 车辆管理、订单流程、取还车执行、定价策略
- 众筹业务: 项目管理、份额交易、收益分配、众筹车主积分
- 营地预订: 营位管理、预订模式(实时/咨询)、库存管理
- 定制旅游: 路线管理、批次管理、服务模式(自驾/管家随行)
- 特惠租车: 套餐管理、固定租期、限时促销

**开发规范**:

- 规范先行原则: 开发前先查阅相关规范,制定符合规范的方案
- 开发检查点: 组件开发完成后必须进行规范符合性自检
- 页面提交前执行规范检查清单核验
- 使用 OpenSpec 管理变更提案和规范文档

**开发进度管理**: 见 `docs/开发进度管理.md` (290 行)

- 87 个功能模块详细清单和优先级 (P0/P1/P2)
- 开发顺序规划 (平台基础能力 → 纵向闭环切片)
- 依赖关系和里程碑定义
- 开发前检查清单

**业务规则**:

- 具体业务规则由各端功能详细设计文档定义,不在项目级别强制规定
- 参考文档:
  - `docs/小程序端功能详细设计-优化版.md` - C 端用户业务规则
  - `docs/管理端功能详细设计-优化版.md` - PC 管理端业务规则
  - `docs/移动管理端功能详细设计-优化版.md` - 移动管理端业务规则
- 业务规则变更应通过 OpenSpec 变更提案流程进行管理

## Important Constraints

**性能约束**:

- 性能优先: 追求最佳用户体验和响应速度
- 页面加载时间: 首屏<2 秒,交互响应<300ms
- API 响应时间: 平均<500ms,P99<2s
- 数据库查询: 单次查询<100ms

**资源约束**:

- 资源效率: 合理利用本地资源,避免不必要的网络请求
- 优先使用本地功能: 自身能完成的任务,应优先使用本地功能,不调用外部服务
- 图片压缩: 上传图片自动压缩,单张<500KB
- 缓存策略: 合理使用 Redis 缓存,减少数据库压力

**安全约束**:

- HTTPS 全站加密
- 敏感数据加密存储(密码、身份证号等)
- JWT Token 认证,过期时间 2 小时
- API 接口限流,防止恶意攻击
- SQL 注入、XSS、CSRF 防护

**业务约束**:

- 实名认证: 租车用户必须完成实名认证和驾照认证
- 支付安全: 订单金额二次验证,支付回调签名验证
- 数据备份: 每日自动备份,异地存储
- 审计日志: 关键操作记录审计日志

**文档管理约束**:

- ❌ 严格禁止创建完成报告、修复报告、临时说明文档、重复文档
- ❌ 严格禁止创建无实际价值的总结性文档
- ✅ 仅允许创建技术规范文档、API 文档、数据库设计文档、用户手册

**项目文档索引**:

**核心规范文档**:

- `openspec/AGENTS.md` - AI 助手 OpenSpec 工作流程指南（OpenSpec 官方规范）
- `openspec/project.md` (本文档) - 项目上下文和约束（项目特定配置）

**技术文档**:

- `docs/完整开发历史与交接文档.md` - 完整开发历史、问题解决方案、代码位置索引
- `docs/技术规范手册.md` - 技术选型、多端编译约束、开发规范
- `docs/数据字典.md` - 数据模型定义、枚举值、字段规范
- `docs/开发进度管理.md` - 功能模块清单、开发顺序、里程碑

**OpenSpec 目录结构**:

```
openspec/
├── project.md                      # 项目上下文（本文档）
├── AGENTS.md                       # OpenSpec 工作流程指南
├── specs/                          # 当前真相 - 已构建的功能
│   └── [capability]/
│       ├── spec.md                 # 需求和场景
│       └── design.md               # 技术模式（可选）
├── changes/                        # 提案 - 应该变更的内容
│   ├── [change-id]/
│   │   ├── proposal.md             # 为什么、改什么、影响
│   │   ├── tasks.md                # 实现清单
│   │   ├── design.md               # 技术决策（可选）
│   │   └── specs/
│   │       └── [capability]/
│   │           └── spec.md         # ADDED/MODIFIED/REMOVED
│   └── archive/                    # 已完成的变更
│       └── YYYY-MM-DD-[change-id]/ # 归档的变更
```

## External Dependencies

**支付服务**:

- 微信支付: 小程序支付、H5 支付、退款
- 支付宝支付: 小程序支付、H5 支付、退款

**云服务**:

- 阿里云 OSS: 图片存储、文件存储
- 阿里云 CDN: 静态资源加速(可选)
- 阿里云 DNS: 域名解析

**第三方平台**:

- 微信开放平台: 小程序、客服消息接口
- 支付宝开放平台: 小程序、客服消息接口
- 抖音开放平台: 小程序、客服消息接口

**短信服务**:

- 阿里云短信: 验证码、订单通知

**地图服务**:

- 腾讯地图/高德地图: 位置定位、导航

**实名认证**:

- 第三方实名认证服务(待选型)

**监控告警**:

- 服务器监控: 宝塔面板自带监控
- 应用监控: PM2 监控
- 日志分析: Winston 日志
