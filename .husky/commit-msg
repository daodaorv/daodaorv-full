#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

# 验证 commit message 格式
commit_msg_file=$1
commit_msg=$(cat "$commit_msg_file")

# 正则表达式：type(scope): subject
pattern="^(feat|fix|docs|style|refactor|perf|test|chore)(\(.+\))?: .{1,100}"

if ! echo "$commit_msg" | grep -qE "$pattern"; then
  echo "❌ Commit message 格式错误!"
  echo ""
  echo "正确格式："
  echo "  <type>(<scope>): <subject>"
  echo ""
  echo "示例："
  echo "  feat(auth): 添加用户登录功能"
  echo "  fix(order): 修复订单金额计算错误"
  echo ""
  echo "Type 类型："
  echo "  feat:     新功能"
  echo "  fix:      修复bug"
  echo "  docs:     文档更新"
  echo "  style:    代码格式调整"
  echo "  refactor: 代码重构"
  echo "  perf:     性能优化"
  echo "  test:     测试相关"
  echo "  chore:    构建工具或辅助工具的变动"
  echo ""
  exit 1
fi

